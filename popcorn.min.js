(function(l,k){var q=Array.prototype.forEach,t=Object.prototype.hasOwnProperty,u=Array.prototype.slice,v=/^(#([\w\-\_\.]+))$/,m=[],r=!1,b=function(a){return new b.p.init(a)};b.p=b.prototype={init:function(a){var c;if("function"===typeof a)if("interactive"===k.readyState||"complete"===k.readyState)a(k,b);else{if(m.push(a),!r){r=!0;var d=function(){k.removeEventListener("DOMContentLoaded",d,!1);for(var a=0;a<m.length;a++)m[a].call(k,b);m=null};k.addEventListener("DOMContentLoaded",d,!1)}}else{a=v.exec(a);
a.length&&a[2]&&(c=k.getElementById(a[2]));this.video=c?c:null;this.data={history:[],events:{},trackEvents:{byStart:[{start:-1,end:-1}],byEnd:[{start:-1,end:-1}],startIndex:0,endIndex:0,previousUpdateTime:0}};var e=function(a){if(3<=a.video.readyState){var c=a.video.duration+1;b.addTrackEvent(a,{start:c,end:c});a.video.addEventListener("timeupdate",function(b){var c=this.currentTime,e=a.data.trackEvents.previousUpdateTime,d=a.data.trackEvents,f=d.byEnd,h=d.byStart;if(e<c){for(;f[d.endIndex]&&f[d.endIndex].end<=
c;)!0===f[d.endIndex]._running&&(f[d.endIndex]._running=!1,f[d.endIndex]._natives.end.call(a,b,f[d.endIndex])),d.endIndex++;for(;h[d.startIndex]&&h[d.startIndex].start<=c;)h[d.startIndex].end>c&&!1===h[d.startIndex]._running&&(h[d.startIndex]._running=!0,h[d.startIndex]._natives.start.call(a,b,h[d.startIndex])),d.startIndex++}else if(e>c){for(;h[d.startIndex]&&h[d.startIndex].start>c;)!0===h[d.startIndex]._running&&(h[d.startIndex]._running=!1,h[d.startIndex]._natives.end.call(a,b,h[d.startIndex])),
d.startIndex--;for(;f[d.endIndex]&&f[d.endIndex].end>c;)f[d.endIndex].start<=c&&!1===f[d.endIndex]._running&&(f[d.endIndex]._running=!0,f[d.endIndex]._natives.start.call(a,b,f[d.endIndex])),d.endIndex--}d.previousUpdateTime=c},!1)}else l.setTimeout(function(){e(a)},1)};e(this);return this}}};b.p.init.prototype=b.p;b.forEach=function(a,c,d){if(!a||!c)return{};d=d||this;if(q&&a.forEach===q)return a.forEach(c,d);for(var b in a)t.call(a,b)&&c.call(d,a[b],b,a);return a};b.extend=function(a){var c=a,d=
u.call(arguments,1);b.forEach(d,function(a){for(var b in a)c[b]=a[b]});return c};b.extend(b,{error:function(a){throw a;},guid:function(a){b.guid.counter++;return(a?a:"")+(+new Date+b.guid.counter)},sizeOf:function(a){var b=0,d;for(d in a)b++;return b},nop:function(){}});b.guid.counter=1;b.extend(b.p,function(){var a={};b.forEach("load play pause currentTime playbackRate mute volume duration".split(/\s+/g),function(b){a[b]=function(a){return"function"===typeof this.video[b]?(this.video[b](),this):
!1!==a&&null!==a&&"undefined"!==typeof a?(this.video[b]=a,this):this.video[b]}});return a}());b.extend(b.p,{roundTime:function(){return-~this.video.currentTime},exec:function(a,c){!c&&(c=b.nop);var d=this,e=function(b){this.currentTime()>=a&&!e.fired&&(e.fired=!0,this.unlisten("execCallback"),c.call(d,b))};e.fired=!1;this.listen("timeupdate",e);return this},removePlugin:function(a){var c=this.data.trackEvents.byStart,d=this.data.trackEvents.byEnd;delete b.p[a];for(var e=0,g=b.registry.length;e<g;e++)if(b.registry[e].type===
a){b.registry.splice(e,1);break}e=0;for(g=c.length;e<g;e++)c[e]&&c[e]._natives&&c[e]._natives.type===a&&(c.splice(e,1),e--,g--,this.data.trackEvents.startIndex<=e&&this.data.trackEvents.startIndex--);c=0;for(e=d.length;c<e;c++)d[c]&&d[c]._natives&&d[c]._natives.type===a&&(d.splice(c,1),c--,e--,this.data.trackEvents.endIndex<=c&&this.data.trackEvents.endIndex--);return this}});b.Events={UIEvents:"blur focus focusin focusout load resize scroll unload  ",MouseEvents:"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave click dblclick",
Events:"loadstart progress suspend emptied stalled play pause loadedmetadata loadeddata waiting playing canplay canplaythrough seeking seeked timeupdate ended ratechange durationchange volumechange"};b.Events.Natives=b.Events.UIEvents+" "+b.Events.MouseEvents+" "+b.Events.Events;b.events={isNative:function(a){for(var c=b.Events.Natives.split(/\s+/g),d=0;d<c.length;d++)if(c[d]===a)return!0;return!1},getInterface:function(a){if(!b.events.isNative(a))return!1;var c=b.Events,d,e;for(e in c)"Natives"!==
e&&-1<c[e].indexOf(a)&&(d=e);return d},all:b.Events.Natives.split(/\s+/g),fn:{trigger:function(a,c){if(this.data.events[a]&&b.sizeOf(this.data.events[a])){var d=b.events.getInterface(a);if(d)return d=k.createEvent(d),d.initEvent(a,!0,!0,l,1),this.video.dispatchEvent(d),this;b.forEach(this.data.events[a],function(a,b){a.call(this,c)},this)}return this},listen:function(a,c){var d=this,e=!0;this.data.events[a]||(this.data.events[a]={},e=!1);this.data.events[a][c.name||c.toString()+b.guid()]=c;!e&&-1<
b.events.all.indexOf(a)&&this.video.addEventListener(a,function(c){b.forEach(d.data.events[a],function(a,b){"function"===typeof a&&a.call(d,c)})},!1);return this},unlisten:function(a,b){if(this.data.events[a]&&this.data.events[a][b])return this.data.events[a][b]=null,this;this.data.events[a]=null;return this},special:{play:function(){}}}};b.forEach(["trigger","listen","unlisten"],function(a){b.p[a]=b.events.fn[a]});b.protect={natives:"load play pause currenttime playbackrate mute volume duration removeplugin roundtime trigger listen unlisten".split(/\s+/)};
b.addTrackEvent=function(a,c){c._natives&&(c._id=c.id?c.id:b.guid(c._natives.type),a.data.history.push(c._id));a.data.trackEvents.byStart.push(c);a.data.trackEvents.byEnd.push(c);a.data.trackEvents.byStart.sort(function(a,b){return a.start-b.start});a.data.trackEvents.byEnd.sort(function(a,b){return a.end-b.end})};b.removeTrackEvent=function(a,c){var d=a.data.history.length,e=0,g=[],f=[],p=[];b.forEach(a.data.trackEvents.byStart,function(b,d,p){b._id||(g.push(a.data.trackEvents.byStart[d]),f.push(a.data.trackEvents.byEnd[d]));
b._id&&(b._id!==c&&(g.push(a.data.trackEvents.byStart[d]),f.push(a.data.trackEvents.byEnd[d])),b._id===c&&(e=d))});e<=a.data.trackEvents.startIndex&&a.data.trackEvents.startIndex--;e<=a.data.trackEvents.endIndex&&a.data.trackEvents.endIndex--;a.data.trackEvents.byStart=g;a.data.trackEvents.byEnd=f;for(var n=0;n<d;n++)a.data.history[n]!==c&&p.push(a.data.history[n]);a.data.history=p};b.getTrackEvents=function(a){var c=[];b.forEach(a.data.trackEvents.byStart,function(a,b,g){a._id&&c.push(a)});return c};
b.getLastTrackEventId=function(a){return a.data.history[a.data.history.length-1]};b.extend(b.p,{getTrackEvents:function(){return b.getTrackEvents.call(null,this)},getLastTrackEventId:function(){return b.getLastTrackEventId.call(null,this)},removeTrackEvent:function(a){b.removeTrackEvent.call(null,this,a);return this}});b.manifest={};b.registry=[];b.plugin=function(a,c){if(0<=b.protect.natives.indexOf(a.toLowerCase()))b.error("'"+a+"' is a protected function name");else{var d=["start","end"],e={type:a},
g,f;"object"===typeof c&&(f=c,g=function(c){if(!c)return this;c._natives=f;c._natives.type=a;c._running=!1;"start"in c||(c.start=0);"end"in c||(c.end=this.duration());"_setup"in f&&"function"===typeof f._setup&&(c.target||f.manifest.options.target&&(c.target=f.manifest.options.target),f._setup.call(this,c));b.addTrackEvent(this,c);b.forEach(f,function(a,b){"type"!==b&&-1===d.indexOf(b)&&this.listen(b,a)},this);return this});if("function"===typeof c)f=c.call(this),"object"!==typeof f||"length"in f||
b.plugin(a,f);else return e[a]=g,b.extend(b.p,e),b.registry.push(e),"manifest"in f&&(b.manifest[a]=f.manifest),e}};b.parsers={};b.parser=function(a,c,d){if(0<=b.protect.natives.indexOf(a.toLowerCase()))b.error("'"+a+"' is a protected function name");else if("function"===typeof d){var e={};e[a]=function(a){if(!a)return this;var c=this;b.xhr({url:a,success:function(a){a=d(a);for(var b=0,e=a.data.length;b<e;b++)for(var g in a.data[b])if(a.data[b].hasOwnProperty(g))c[g](a.data[b][g])}});return this};
b.extend(b.p,e);b.parsers[c]=a;return e}};var w={url:"",data:"",dataType:"",success:b.nop,type:"GET",async:!0,xhr:function(){return new l.XMLHttpRequest}};b.xhr=function(a){a=b.extend({},w,a);a.ajax=a.xhr();if(a.ajax)return a.ajax.open(a.type,a.url,a.async),a.ajax.send(null),b.xhr.httpData(a)};b.xhr.httpData=function(a){var b,d=null;a.ajax.onreadystatechange=function(){if(4===a.ajax.readyState){try{d=JSON.parse(a.ajax.responseText)}catch(e){}b={xml:a.ajax.responseXML,text:a.ajax.responseText,json:d};
a.success.call(a.ajax,b)}};return b};l.Popcorn=b;k.addEventListener("DOMContentLoaded",function(){var a=k.getElementsByTagName("video");b.forEach(a,function(c,d){var e=a[d],g;e.nodeType&&1===e.nodeType&&e.id&&(g=e.getAttribute("data-timeline-sources"))&&(e=b("#"+e.id).parseXML(g),e.autoplay&&e.play())})},!1)})(window,window.document);